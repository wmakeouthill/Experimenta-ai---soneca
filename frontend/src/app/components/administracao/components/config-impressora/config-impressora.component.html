<div class="config-impressora-container">
  <div class="config-impressora-header" (click)="alternarExpansao()">
    <h2 class="config-impressora-titulo">
      üñ®Ô∏è Configura√ß√£o de Impressora
    </h2>
    <span class="config-impressora-toggle">
      {{ estaExpandido() ? '‚ñº' : '‚ñ∂' }}
    </span>
  </div>

  @if (estaExpandido()) {
    <div class="config-impressora-content">
      <form [formGroup]="formImpressora" class="config-impressora-form">
        <div class="form-row">
          <label for="tipoImpressora">Tipo de Impressora:</label>
          <select 
            id="tipoImpressora" 
            formControlName="tipoImpressora" 
            class="form-input-compact"
          >
            @for (tipo of tiposImpressora; track tipo.value) {
              <option [value]="tipo.value">{{ tipo.label }}</option>
            }
          </select>
        </div>

        <div class="form-row form-row-logo">
          <label>Logo (PNG):</label>
          <div class="logo-upload-container">
            @if (logoPreview()) {
              <div class="logo-preview">
                <img [src]="logoPreview()" alt="Logo preview" />
                <button type="button" class="btn-remover-logo" (click)="removerLogo()">‚úï</button>
              </div>
            } @else {
              <input
                #logoInput
                type="file"
                accept="image/png,image/jpeg"
                (change)="onLogoSelecionado($event)"
                class="logo-input"
              />
            }
          </div>
        </div>

        <div class="form-row">
          <label for="nomeEstabelecimento">Nome do Estabelecimento *:</label>
          <input
            id="nomeEstabelecimento"
            type="text"
            formControlName="nomeEstabelecimento"
            class="form-input-compact"
            [class.invalid]="nomeEstabelecimento?.invalid && nomeEstabelecimento?.touched"
            placeholder="Ex: experimenta-ai-do-soneca"
          />
          @if (nomeEstabelecimento?.invalid && nomeEstabelecimento?.touched) {
            <span class="error-text">Obrigat√≥rio</span>
          }
        </div>

        <div class="form-row">
          <label for="enderecoEstabelecimento">Endere√ßo:</label>
          <input
            id="enderecoEstabelecimento"
            type="text"
            formControlName="enderecoEstabelecimento"
            class="form-input-compact"
            placeholder="Ex: Rua Exemplo, 123 - Centro"
          />
        </div>

        <div class="form-row">
          <label for="telefoneEstabelecimento">Telefone:</label>
          <input
            id="telefoneEstabelecimento"
            type="text"
            formControlName="telefoneEstabelecimento"
            class="form-input-compact"
            placeholder="Ex: (21) 97439-7966"
          />
        </div>

        <div class="form-row">
          <label for="cnpjEstabelecimento">CNPJ:</label>
          <input
            id="cnpjEstabelecimento"
            type="text"
            formControlName="cnpjEstabelecimento"
            class="form-input-compact"
            placeholder="Ex: 12345678000190"
            maxlength="14"
          />
        </div>

        @if (mensagemImpressao()) {
          <div class="mensagem-impressao" [class.sucesso]="mensagemImpressao()?.startsWith('‚úÖ')">
            {{ mensagemImpressao() }}
          </div>
        }

        <div class="config-impressora-actions">
          @if (isAdministrador()) {
            <button
              type="button"
              class="btn-compact btn-salvar"
              (click)="salvarConfiguracao()"
              [disabled]="formImpressora.invalid || estaSalvando()"
            >
              @if (estaSalvando()) {
                üíæ Salvando...
              } @else {
                üíæ Salvar
              }
            </button>
          }
          <button
            type="button"
            class="btn-compact btn-test-impressao"
            (click)="testarImpressao()"
            [disabled]="formImpressora.invalid || estaImprimindo()"
          >
            @if (estaImprimindo()) {
              ‚è≥ Testando...
            } @else {
              üß™ Testar
            }
          </button>
        </div>
      </form>
    </div>
  }
</div>

